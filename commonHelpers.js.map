{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/img/icon-error.svg","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const searchParams = {\n  query: '',\n  perPage: 15,\n  maxPage: 1,\n  currentPage: 1,\n};\n\nexport async function searchPhoto(query, page) {\n  const API_KEY = '43980241-153c3487497bc06835a433946';\n\n  const response = await axios.get('/api/', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: 15,\n      page: page,\n    },\n  });\n\n  return response.data;\n}\n","function photoTemplate(obj) {\n  return `<div class=\"gallery-item\">\n  <a href=\"${obj.largeImageURL}\">\n    <img src=\"${obj.webformatURL}\" alt=\"${obj.tags}\" loading=\"lazy\"/>\n  </a>\n  <ul class=\"block-info\">\n    <li>\n      <p style=\"font-weight: 600\">Likes</p>\n      <p>${obj.likes}</p>\n    </li>\n\n    <li>\n      <p style=\"font-weight: 600\">Views</p>\n      <p>${obj.views}</p>\n    </li>\n\n    <li>\n      <p style=\"font-weight: 600\">Comments</p>\n      <p>${obj.comments}</p>\n    </li>\n\n    <li>\n      <p style=\"font-weight: 600\">Downloads</p>\n      <p>${obj.downloads}</p>\n    </li>\n  </ul>\n</div>`;\n}\n\nfunction photosTemplate(arr) {\n  return arr.map(photoTemplate).join('');\n}\n\nexport function renderMarkup(element, arr) {\n  const markup = photosTemplate(arr);\n  element.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function renderMarkupPagination(currentPage, totalPage) {\n  let paginationMarkup =\n    '<li data-type=\"prev\" class=\"pagination-item btn\">&laquo;</li>';\n\n  let startPage = 1;\n  let endPage = totalPage;\n\n  if (totalPage > 7) {\n    if (currentPage > 4) {\n      paginationMarkup += '<li class=\"dots\">&nbsp;. . .&nbsp;</li>';\n      startPage = currentPage - 2;\n    }\n\n    if (currentPage < totalPage - 3) {\n      endPage = currentPage + 2;\n    }\n  }\n\n  for (let i = startPage; i <= endPage; i += 1) {\n    paginationMarkup += `<li data-type=\"page\" data-page=\"${i}\" class=\"pagination-item btn ${\n      currentPage === i ? 'active' : ''\n    }\">${i}</li>`;\n  }\n\n  if (endPage < totalPage) {\n    paginationMarkup += '<li class=\"dots\">&nbsp;. . .&nbsp;</li>';\n  }\n\n  paginationMarkup +=\n    '<li data-type=\"next\" class=\"pagination-item btn\">&raquo;</li>';\n\n  return paginationMarkup;\n}\n","export default \"__VITE_ASSET__eb775c6f__\"","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport axios from 'axios';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport './css/loader.css';\n\nimport './js/pixabay-api';\nimport './js/render-functions';\n\nimport iconError from './img/icon-error.svg';\nimport { searchParams, searchPhoto } from './js/pixabay-api';\nimport { renderMarkup, renderMarkupPagination } from './js/render-functions';\n\nlet { query, perPage, maxPage, currentPage } = searchParams;\nlet hits;\n\nexport const ref = {\n  form: document.querySelector('.js-form'),\n  containerImg: document.querySelector('.js-container-images'),\n  body: document.body,\n  cssLoader: document.querySelector('.js-loader'),\n  btnLoadMore: document.querySelector('.js-btn-load-more'),\n  pagination: document.querySelector('.js-pagination'),\n};\n\nconst lightbox = new SimpleLightbox('.js-container-images a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionClass: 'caption-text',\n});\n\nref.form.addEventListener('submit', handleSubmitPhotoRequest);\nref.btnLoadMore.addEventListener('click', handleClickPhotoReload);\nref.pagination.addEventListener('click', handlePaginationClick);\n\nfunction handleSubmitPhotoRequest(event) {\n  event.preventDefault();\n\n  hideElement(ref.btnLoadMore);\n  hideElement(ref.pagination);\n\n  const elementOfForm = event.target;\n\n  ref.body.style.height = '100vh';\n  ref.containerImg.innerHTML = '';\n\n  currentPage = 1;\n\n  query = elementOfForm.elements.query.value.trim();\n\n  if (query === '') {\n    hideElement(ref.btnLoadMore);\n    hideElement(ref.pagination);\n    message({ text: 'Fill in the field!' });\n\n    return;\n  }\n\n  query = query.replaceAll(' ', '+');\n\n  uploadPhoto(query, currentPage);\n\n  elementOfForm.reset();\n}\n\nasync function uploadPhoto(query) {\n  showElement(ref.cssLoader);\n  hideElement(ref.btnLoadMore);\n  hideElement(ref.pagination);\n\n  try {\n    const result = await searchPhoto(query, currentPage);\n\n    if (!result.hits || result.hits.length === 0) {\n      hideElement(ref.btnLoadMore);\n      hideElement(ref.pagination);\n      message({\n        text: 'Sorry, there are no images matching your<br> search query. Please, try again!',\n      });\n    } else {\n      maxPage = Math.ceil(result.totalHits / perPage);\n      hits = result.hits;\n\n      renderMarkup(ref.containerImg, result.hits);\n\n      showElement(ref.pagination);\n      showElement(ref.btnLoadMore);\n\n      paginationPage(currentPage, maxPage);\n\n      if (result.hits.length < 4) {\n        ref.body.style.height = '100vh';\n        hideElement(ref.btnLoadMore);\n      } else ref.body.style.height = '100%';\n\n      lightbox.refresh();\n    }\n  } catch (error) {\n    message({\n      text: 'An error occurred. Please try again later.',\n      title: `Error ${error.status}:`,\n    });\n  } finally {\n    hideElement(ref.cssLoader);\n  }\n\n  status();\n}\n\nasync function handleClickPhotoReload() {\n  hideElement(ref.btnLoadMore);\n  showElement(ref.cssLoader);\n\n  try {\n    currentPage += 1;\n\n    const result = await searchPhoto(query, currentPage);\n    renderMarkup(ref.containerImg, result.hits);\n\n    showElement(ref.btnLoadMore);\n\n    scrollAutoAfterClickOnBtn();\n\n    paginationPage(currentPage, maxPage);\n\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideElement(ref.cssLoader);\n  }\n  status();\n}\n\nfunction handlePaginationClick(event) {\n  const activeEl = ref.pagination.querySelector('.active');\n  const currentEl = event.target;\n\n  if (currentEl.dataset.type === 'page') {\n    const pageNumber = parseInt(currentEl.dataset.page);\n\n    if (pageNumber !== currentPage) {\n      currentPage = pageNumber;\n      ref.containerImg.innerHTML = '';\n      ref.body.style.height = '100vh';\n      uploadPhoto(query, currentPage);\n    }\n  }\n\n  if (\n    currentEl.dataset.type === 'prev' &&\n    activeEl.previousElementSibling.dataset.type === 'page'\n  ) {\n    updateActivePage(currentEl, activeEl);\n  }\n\n  if (\n    currentEl.dataset.type === 'next' &&\n    activeEl.nextElementSibling.dataset.type === 'page'\n  ) {\n    updateActivePage(currentEl, activeEl);\n  }\n}\n\nfunction updateActivePage(currentBtn, activeBtn) {\n  activeBtn.classList.remove('active');\n\n  if (currentBtn.dataset.type === 'page') {\n    currentBtn.classList.add('active');\n    return;\n  }\n\n  if (currentBtn.dataset.type === 'next') {\n    activeBtn.nextElementSibling.classList.add('active');\n    currentPage += 1;\n  } else {\n    activeBtn.previousElementSibling.classList.add('active');\n    currentPage -= 1;\n  }\n\n  if (currentPage < 1 || currentPage > maxPage) return;\n\n  ref.containerImg.innerHTML = '';\n  ref.body.style.height = '100vh';\n  uploadPhoto(query, currentPage);\n}\n\nfunction paginationPage(currentPage, maxPage) {\n  ref.pagination.innerHTML = renderMarkupPagination(currentPage, maxPage);\n}\n\nfunction status() {\n  if (currentPage >= maxPage) {\n    hideElement(ref.btnLoadMore);\n    if (hits.length < 4) return;\n    message({\n      text: \"We're sorry, but you've reached the end of search results.\",\n      type: 'info',\n    });\n  }\n}\n\nfunction showElement(element) {\n  element.classList.remove('visually-hidden');\n}\n\nfunction hideElement(element) {\n  element.classList.add('visually-hidden');\n}\n\nfunction message({ text, title = null, type = 'error' }) {\n  iziToast.settings({\n    timeout: 5000,\n    closeOnEscape: true,\n    transitionIn: 'fadeInLeft',\n    transitionOut: 'fadeOutUp',\n    titleSize: '16',\n    titleLineHeight: '24',\n    messageSize: '16',\n    messageLineHeight: '24',\n    position: 'topRight',\n  });\n  switch (type) {\n    case 'info':\n      iziToast.info({\n        message: text,\n      });\n\n      const close = document.querySelector('.iziToast-close');\n      close.classList.add('custom-close');\n      break;\n    default:\n      const toastParams = {\n        message: text,\n        backgroundColor: '#EF4040',\n        iconUrl: iconError,\n        titleColor: '#FFF',\n        messageColor: '#FFF',\n      };\n      if (title !== null) {\n        toastParams.title = `${title}`;\n      }\n\n      iziToast.show(toastParams);\n  }\n}\n\nfunction scrollAutoAfterClickOnBtn() {\n  const findHeightEl = document.querySelector('.gallery-item');\n  const heightEl = findHeightEl.getBoundingClientRect().height;\n  window.scrollBy({\n    top: heightEl * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","searchParams","searchPhoto","query","page","API_KEY","photoTemplate","obj","photosTemplate","arr","renderMarkup","element","markup","renderMarkupPagination","currentPage","totalPage","paginationMarkup","startPage","endPage","i","iconError","perPage","maxPage","hits","ref","lightbox","SimpleLightbox","handleSubmitPhotoRequest","handleClickPhotoReload","handlePaginationClick","event","hideElement","elementOfForm","message","uploadPhoto","showElement","result","paginationPage","error","status","scrollAutoAfterClickOnBtn","activeEl","currentEl","pageNumber","updateActivePage","currentBtn","activeBtn","text","title","type","iziToast","toastParams","heightEl"],"mappings":"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"}